---
- name: List the HMC current build level
  hmc_update_upgrade:
      hmc_host: '{{ inventory_hostname }}'
      hmc_auth: '{{ curr_hmc_auth }}'
      state: facts
  register: result

- assert:
    that:
      - result is success

- name: Update the HMC to 910.6 from 910 using NFS
  hmc_update_upgrade:
      hmc_host: '{{ inventory_hostname }}'
      hmc_auth: '{{ curr_hmc_auth }}'
      build_config: '{{ config3 }}'
      state: updated
  register: result

- assert:
    that:
      - result is success
      - result is changed

- name: Upgrade the HMC to 950 build level using nfs
  hmc_update_upgrade:
      hmc_host: '{{ inventory_hostname }}'
      hmc_auth: '{{ curr_hmc_auth }}'
      build_config: '{{ config5 }}'
      state: upgraded
  register: result

- assert:
    that:
      - result is success
      - result is changed

- name: Error-Reports error when wrong sshkey_file path is specified in sftp
  hmc_update_upgrade:
      hmc_host: '{{ inventory_hostname }}'
      hmc_auth: '{{ curr_hmc_auth }}'
      build_config: '{{ config6 }}'
      state: upgraded
  register: result
  ignore_errors: yes

- assert:
    that:
      - "'The user ID and password or key combination is not valid.' in result.msg"
      - result is failed
      - result is not changed

- name: Error-Reports error when wrong build_file is specified for sftp
  hmc_update_upgrade:
      hmc_host: '{{ inventory_hostname }}'
      hmc_auth: '{{ curr_hmc_auth }}'
      build_config: '{{ config7 }}'
      state: upgraded
  register: result
  ignore_errors: yes

- assert:
    that:
      - "'Verify the remote directory exists, all required files needed for upgrade' in result.msg"
      - result is failed
      - result is not changed

- name: Error-Reports error when wrong server is specified for NFS
  hmc_update_upgrade:
      hmc_host: '{{ inventory_hostname }}'
      hmc_auth: '{{ curr_hmc_auth }}'
      build_config: '{{ config8 }}'
      state: upgraded
  register: result
  ignore_errors: yes

- assert:
    that:
      - "'An error was detected while mounting the remote server.' in result.msg"
      - result is failed
      - result is not changed

- name: Error-Reports error when wrong mount location is specified for NFS
  hmc_update_upgrade:
      hmc_host: '{{ inventory_hostname }}'
      hmc_auth: '{{ curr_hmc_auth }}'
      build_config: '{{ config9 }}'
      state: upgraded
  register: result
  ignore_errors: yes

- assert:
    that:
      - "'An error was detected while mounting the remote server.' in result.msg"
      - result is failed
      - result is not changed

- name: Error-Reports error when wrong not existing build_file path is specified for Disk Update
  hmc_update_upgrade:
      hmc_host: '{{ inventory_hostname }}'
      hmc_auth: '{{ curr_hmc_auth }}'
      build_config: '{{ config2 }}'
      state: updated
  register: result
  ignore_errors: yes

- assert:
    that:
      - "'Error: copy of image to hmc failed' in result.msg"
      - result is failed
      - result is not changed

- name: Error-Reports error when wrong not existing build_file path is specified for Disk Upgrade
  hmc_update_upgrade:
      hmc_host: '{{ inventory_hostname }}'
      hmc_auth: '{{ curr_hmc_auth }}'
      build_config: '{{ config2 }}'
      state: upgraded
  register: result
  ignore_errors: yes

- assert:
    that:
      - "'ParameterError: not able to list files on mentioned local path' in result.msg"
      - result is failed
      - result is not changed
